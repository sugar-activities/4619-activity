    {% extends "base.html" %}
    {% block view %}
    <div class="scrollable" id="scrollable">
        <div class="items">
            {%- for item in range(page-1) %}
            <div class='context-grid-box' id="resource-page-{{item+1}}">
                <div id='throbber-box'>
                    <img id='throbber' src="/static/images/throbber10.gif" />
                </div>
            </div>
            {%- endfor %}
            {% include '_browser-grid.html' %}
            {%- for item in range(total_pages-page) %}
            <div class='context-grid-box' id="resource-page-{{item+page+1}}">
                <div id='throbber-box'>
                    <img id='throbber' src="/static/images/throbber10.gif" />
                </div>
            </div>
            {%- endfor %}
        </div>
    </div>
    <script type='text/javascript'>
        $(function() {
            // initialize scrollable
            $(".scrollable").scrollable({easing: 'swing'});
            var api = $("#scrollable").data("scrollable");
            var last_page = {{page}};
            
            function load_adyacent_pages(page) {
                if (page-1 > 0) {
                    $.get( '?page='+(page-1)+'&_pjax', { },
                      function( data ) {
                        $( '#resource-page-'+(page-1)).empty().append( data );
                        init_styles('#fff');
                      });
                    }
                if (page+1 <= {{total_pages}}) {
                    $.get( '?page='+(page+1)+'&_pjax', { },
                      function( data ) {
                        $( '#resource-page-'+(page+1) ).empty().append( data );
                        init_styles('#fff');
                      });
                    }
            }

            // Slider control
            $("#range").rangeinput();
            $("#range").change(function(event, value) {
                api.seekTo(value-1); 
                });
            range_api = $("#range").data("rangeinput");

            api.seekTo({{page-1}},0);
            load_adyacent_pages({{page}});

            api.onSeek( function() {
                new_page = api.getIndex()+1;
                $('div.generic_tooltip').hide();
                if (new_page != last_page+1 && new_page != last_page-1) {
                    History.pushState(null,null,'?page=' + new_page);

                    range_api.setValue(new_page);

                    $.get( '?page='+new_page+'&_pjax', { },
                      function( data ) {
                        $( '#resource-page-'+new_page ).empty().append( data );
                        init_styles('#fff');
                      }
                    );
                    $( '#resource-page-'+last_page ).empty().append('<div id="throbber-box"><img id="throbber" src="/static/images/throbber10.gif" /></div>'); 
                    last_page=new_page;
                    $( '#info' ).empty().append('{% trans %}page '+new_page+' of{% endtrans %} {{total_pages}}');
                    load_adyacent_pages(new_page);
                }
                else {
                    History.pushState(null,null,'?page=' + new_page);
                    load_adyacent_pages(new_page);
                    range_api.setValue(new_page);
                    last_page=new_page;
                    $( '#info' ).empty().append('{% trans %}page '+new_page+' of{% endtrans %} {{total_pages}}');
                }
            });
        });
        $(document).ready(function() {
            init_styles('#fff');
            var api = $("#scrollable").data("scrollable");
            api.focus();
        });
    </script>
    {% endblock view %}
    {%- block bottom_palette %}
    <div id='paginator'>
        <input id="range" type="range" name="paginator" min="1" max="{{total_pages}}" step="1" value="{{page}}" />
    </div>
    <div id='nav-buttons'>
        <a class="prev browse left"></a>
        <a class="next browse right"></a>
    </div>
    {%- endblock bottom_palette %}
